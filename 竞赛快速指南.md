# ğŸ† SSVEPæ¯”èµ›å¿«é€Ÿè¿è¡ŒæŒ‡å—

## ğŸ“Œ æ ¸å¿ƒæ­¥éª¤ï¼ˆ3åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹ï¼‰

### **æ­¥éª¤1ï¼šå®‰è£…ä¾èµ–**
```bash
pip install numpy pandas scikit-learn scipy
```

### **æ­¥éª¤2ï¼šå¯¼å…¥å¹¶åˆå§‹åŒ–æ£€æµ‹å™¨**
```python
from ssvepdetect import ssvepDetect
import pandas as pd

# åˆ›å»ºæ£€æµ‹å™¨
srate = 250  # é‡‡æ ·ç‡
freqs = [16.0, 9.0, 10.0, 11.0, 12.0, 13.0, 10.58, 15.0]  # â­ 8ä¸ªé¢‘ç‡
detector = ssvepDetect(srate, freqs, dataLen=4.0)
```

### **æ­¥éª¤3ï¼šåŠ è½½æ•°æ®å¹¶é¢„æµ‹**
```python
# ä»CSVåŠ è½½æ•°æ®
data = pd.read_csv("test_data.csv")
eeg_signal = data.iloc[:, :6].values.T  # è½¬ç½®ä¸º (é€šé“, æ ·æœ¬)

# è¿›è¡Œé¢„æµ‹
predicted_stim_id = detector.detect(eeg_signal)
print(f"é¢„æµ‹çš„åˆºæ¿€ID: {predicted_stim_id}")  # è¾“å‡º: 0-7
```

---

## ğŸ¯ ä¸‰ç§å¸¸è§æ¯”èµ›åœºæ™¯

### **ã€åœºæ™¯Aã€‘æ¯”èµ›æä¾›CSVæ–‡ä»¶ï¼Œè¦æ±‚è¯†åˆ«æ¯ä¸ªç‰‡æ®µ**

```python
from competition_guide import SSVEPCompetitionRunner

# åˆå§‹åŒ–
runner = SSVEPCompetitionRunner(srate=250, dataLen=4.0)

# æ–¹æ³•1ï¼šåªæµ‹è¯•æŸä¸€ä¸ªåˆºæ¿€
predictions = runner.predict_from_csv("test_data.csv", stim_id=0)

# æ–¹æ³•2ï¼šæµ‹è¯•æ‰€æœ‰åˆºæ¿€
predictions = runner.predict_from_csv("test_data.csv")

# è¾“å‡ºç¤ºä¾‹ï¼š
# âœ“ stimID=0: çœŸå®é¢‘ç‡=16.00Hz, é¢„æµ‹é¢‘ç‡=16.00Hz, é¢„æµ‹ID=0 âœ“
# ğŸ“Š å‡†ç¡®ç‡: 100.0%
```

---

### **ã€åœºæ™¯Bã€‘æ¯”èµ›ç›´æ¥æä¾›EEGæ•°æ®æ•°ç»„**

```python
from competition_guide import SSVEPCompetitionRunner
import numpy as np

# åˆå§‹åŒ–
runner = SSVEPCompetitionRunner(srate=250, dataLen=4.0)

# ä½ çš„EEGæ•°æ® (å½¢çŠ¶: 6ä¸ªé€šé“ Ã— 1000ä¸ªæ ·æœ¬)
eeg_data = np.load("test_eeg.npy")  # æˆ–å…¶ä»–åŠ è½½æ–¹å¼

# è¿›è¡Œé¢„æµ‹
predicted_id, predicted_freq, _ = runner.predict_from_array(eeg_data)

# è¾“å‡ºç¤ºä¾‹ï¼š
# âœ“ é¢„æµ‹æˆåŠŸ!
#   é¢„æµ‹çš„stimID: 2
#   é¢„æµ‹çš„é¢‘ç‡: 10.00 Hz
```

---

### **ã€åœºæ™¯Cã€‘æ‰¹é‡æµ‹è¯•å¹¶ç”Ÿæˆæäº¤æ–‡ä»¶**

```python
from competition_guide import SSVEPCompetitionRunner

# åˆå§‹åŒ–
runner = SSVEPCompetitionRunner(srate=250, dataLen=4.0)

# æ‰¹é‡é¢„æµ‹
runner.batch_predict_and_submit(
    test_csv="test_data.csv",
    output_csv="my_predictions.csv"
)

# è¾“å‡ºæ–‡ä»¶ my_predictions.csvï¼š
# taskID, predicted_stimID, confidence
# 0,      2,                0.9
# 1,      4,                0.9
# ...
```

---

## âš™ï¸ å…³é”®å‚æ•°ä¿®æ”¹

### **é—®é¢˜1ï¼šé‡‡æ ·ç‡ä¸æ˜¯250Hz**
```python
# å¦‚æœä½ çš„æ•°æ®æ˜¯200Hzé‡‡æ ·
runner = SSVEPCompetitionRunner(srate=200, dataLen=4.0)
```

### **é—®é¢˜2ï¼šåˆºæ¿€é¢‘ç‡ä¸åŒ**
```python
# å¦‚æœæ¯”èµ›çš„é¢‘ç‡æ˜¯: 8, 12, 14, 16, 18, 20, 22, 24 Hz
# ä¿®æ”¹ competition_guide.py ä¸­çš„ FREQ_MAP:

# æ‰¾åˆ°è¿™éƒ¨åˆ†:
self.FREQ_MAP = {
    0: 8.0,      # æ”¹ä¸ºä½ çš„é¢‘ç‡
    1: 12.0,
    2: 14.0,
    3: 16.0,
    4: 18.0,
    5: 20.0,
    6: 22.0,
    7: 24.0
}
```

### **é—®é¢˜3ï¼šåªæœ‰4ç§é¢‘ç‡ï¼ˆä¸æ˜¯8ç§ï¼‰**
```python
# ä¿®æ”¹ __init__:
self.FREQ_MAP = {
    0: 9.0,
    1: 12.0,
    2: 15.0,
    3: 20.0
}
self.freqs = [self.FREQ_MAP[i] for i in range(4)]  # æ”¹ä¸º4
```

---

## ğŸ” å¸¸è§é—®é¢˜æ’æŸ¥

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|--------|
| **å‡†ç¡®ç‡0%** | é¢‘ç‡åˆ—è¡¨é¡ºåºé”™äº† | æ£€æŸ¥FREQ_MAPä¸­é¢‘ç‡æ˜¯å¦å¯¹åº”æ­£ç¡®çš„stimID |
| **å‡†ç¡®ç‡å¾ˆä½ï¼ˆ<50%ï¼‰** | æ•°æ®çª—å£å¤ªçŸ­ | å¢åŠ  `dataLen` åˆ°5-6ç§’ |
| **é€Ÿåº¦å¾ˆæ…¢** | dataLenå¤ªé•¿ | å‡å°‘ `dataLen` åˆ°3ç§’ï¼ˆä¼šé™ä½å‡†ç¡®ç‡ï¼‰ |
| **æ•°æ®æ ¼å¼é”™è¯¯** | æ•°æ®ä¸æ˜¯(6, N)çš„å½¢çŠ¶ | ç¡®ä¿æ˜¯ (é€šé“æ•°, æ ·æœ¬æ•°) çš„æ ¼å¼ |
| **CCAæ‹Ÿåˆå¤±è´¥** | æ ·æœ¬æ•°å¤ªå°‘ | ç¡®ä¿æ•°æ®é•¿åº¦ >= dataLen * srate |

---

## ğŸ“Š æ€§èƒ½å‚è€ƒ

| å‚æ•° | å‡†ç¡®ç‡ | å¤„ç†é€Ÿåº¦ |
|------|-------|--------|
| dataLen=2.0ç§’ | 50% | âš¡ å¾ˆå¿« |
| dataLen=3.0ç§’ | 87.5% | âš¡ å¿« |
| dataLen=4.0ç§’ | **100%** â­ | âœ“ å¹³è¡¡ |
| dataLen=5.0ç§’ | 100% | ğŸŒ è¾ƒæ…¢ |
| dataLen=6.0ç§’ | 87.5% | ğŸŒ å¾ˆæ…¢ |

**æ¨èé…ç½®ï¼š`dataLen=4.0`** ï¼ˆå‡†ç¡®ç‡ä¸é€Ÿåº¦çš„æœ€ä½³å¹³è¡¡ï¼‰

---

## ğŸ’¡ å®Œæ•´ä»£ç ç¤ºä¾‹

### **æœ€å°åŒ–å®ç°ï¼ˆä»…éœ€20è¡Œä»£ç ï¼‰**

```python
#!/usr/bin/env python3
import pandas as pd
from ssvepdetect import ssvepDetect

# 1. åˆå§‹åŒ–
srate = 250
freqs = [16.0, 9.0, 10.0, 11.0, 12.0, 13.0, 10.58, 15.0]
detector = ssvepDetect(srate, freqs, dataLen=4.0)

# 2. åŠ è½½æµ‹è¯•æ•°æ®
test_data = pd.read_csv("ExampleData/D1.csv")

# 3. æå–ç¬¬ä¸€ä¸ªåˆºæ¿€çš„æ•°æ®
mask = test_data['stimID'] == 0
eeg = test_data.loc[mask, :'PO4'].values[:1000].T  # (6, 1000)

# 4. é¢„æµ‹
predicted_id = detector.detect(eeg)
print(f"é¢„æµ‹: {predicted_id}")  # è¾“å‡º: 0
```

### **å®Œæ•´å®ç°ï¼ˆåŒ…å«éªŒè¯å’Œè¾“å‡ºï¼‰**

```python
#!/usr/bin/env python3
import pandas as pd
from competition_guide import SSVEPCompetitionRunner

# åˆå§‹åŒ–è¿è¡Œå™¨
runner = SSVEPCompetitionRunner(srate=250, dataLen=4.0)

# åœºæ™¯1ï¼šæµ‹è¯•å•ä¸ªåˆºæ¿€
print("ã€æµ‹è¯•å•ä¸ªåˆºæ¿€ã€‘")
runner.predict_from_csv("ExampleData/D1.csv", stim_id=0)

# åœºæ™¯2ï¼šæ‰¹é‡é¢„æµ‹
print("\nã€æ‰¹é‡é¢„æµ‹ã€‘")
runner.batch_predict_and_submit(
    test_csv="ExampleData/D1.csv",
    output_csv="predictions.csv"
)
```

---

## ğŸš€ æ¯”èµ›å‰æ£€æŸ¥æ¸…å•

- [ ] å®‰è£…äº†æ‰€æœ‰ä¾èµ– (`numpy, pandas, scikit-learn, scipy`)
- [ ] æ£€æŸ¥æ•°æ®æ ¼å¼æ˜¯å¦æ­£ç¡® (CSVæˆ–æ•°ç»„)
- [ ] éªŒè¯äº†åˆºæ¿€é¢‘ç‡åˆ—è¡¨ `FREQ_MAP`
- [ ] æµ‹è¯•äº†è‡³å°‘ä¸€ä¸ªæ ·æœ¬ï¼Œå‡†ç¡®ç‡è¾¾åˆ°é¢„æœŸ
- [ ] è°ƒæ•´äº†æ•°æ®çª—å£é•¿åº¦ `dataLen`
- [ ] ç”Ÿæˆäº†æäº¤æ–‡ä»¶å¹¶æ ¼å¼æ£€æŸ¥æ— è¯¯

---

## ğŸ“ æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | ç”¨é€” |
|------|------|
| `ssvepdetect.py` | â­ æ ¸å¿ƒCCAæ£€æµ‹ç®—æ³• |
| `competition_guide.py` | æ¯”èµ›åœºæ™¯å®Œæ•´å®ç° |
| `test_ssvep_corrected.py` | æµ‹è¯•è„šæœ¬ |
| `optimize_ssvep.py` | å‚æ•°ä¼˜åŒ–å·¥å…· |

---

## ğŸ“ å­¦ä¹ èµ„æº

- **CCAåŸç†**ï¼šæŸ¥çœ‹ `SSVEP_CCAç®—æ³•åˆ†ææ€»ç»“.md`
- **å‚æ•°è°ƒä¼˜**ï¼šè¿è¡Œ `python optimize_ssvep.py`
- **è¯Šæ–­å·¥å…·**ï¼šè¿è¡Œ `python diagnose_ssvep_freq.py`

---

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. é¢‘ç‡åˆ—è¡¨æ˜¯å¦æ­£ç¡®
2. æ•°æ®æ ¼å¼æ˜¯å¦æ­£ç¡®
3. é‡‡æ ·ç‡å‚æ•°æ˜¯å¦æ­£ç¡®
4. æ•°æ®çª—å£é•¿åº¦æ˜¯å¦åˆé€‚

---

**ç¥æ¯”èµ›é¡ºåˆ©ï¼ğŸ†**

æ›´æ–°æ—¶é—´ï¼š2025å¹´11æœˆ11æ—¥
